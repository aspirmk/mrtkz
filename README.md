# mrtkz 
Модуль python 3 для расчета токов короткого замыкания: 
- Реализован на языке высокого уровня Python 3.7 и выше.
- В модуле применяются математические библиотеки numpy и scipy, в том числе используются разреженные матрицы и алгоритмы решения разреженных систем линейных алгебраических уравнений.
- Нахождение электрических параметров токов и напряжений в расчетной схеме модели осуществляется путем решения разреженной системы линейных алгебраических уравнений, которая формируется на основании 1-ого и 2-ого законов Кирхгофа. 
- Метод узловых потенциалов, метод контурных токов не применяются.
- Размерность СЛАУ составляет 3*(nq+np+nn), где  nq,np и nn - соответственно количество узлов, ветвей и несимметрий в модели: для каждого узла, ветви записываются по 3 уравнения для прямой, обратной и нулевой последовательности, а для несимметрий записывается по 3 уравнения - граничные условия. C учетом использования алгоритмов решения разреженных СЛАУ большая размерность СЛАУ не приводит к существенному падению производительности и повышенному потреблению оперативной памяти.
- Формирование расчетной модели сети, целесообразно оформлять в виде скриптов python3, например в среде Spyder (The Scientific Python Development Environment).

Основные возможности:
- Расчет электрических величин токов и напряжений при КЗ и обрывах в сетях любых классов напряжения и любой сложности, ограничения по количеству узлов, ветвей отсутствуют. 
- Поддержка сложных повреждений, осущствляется путем совокупности нескольких КЗ и обрывов, но в одном узле может быть только одно КЗ, а на ветви только один обрыв.
- Поддержка простых ветвей с возможностью независимого задания Z1,Z2,Z0
- Поддержка ветвей с Э.Д.С. и возможностью независимого задания E1,E2,E0 (помимо Z1,Z2,Z0)
- Поддержка ветвей с поперечной емкостной проводимостью B1,B2,B0 (помимо Z1,Z2,Z0)
- Поддержка трансформаторных ветвей для которых необходимо задать (помимо Z1,Z2,Z0) коэф.трансформации и группу соединения обмоток стороны 2 (от 0 до 11), для стороны 1 предусматривается группа соединения обмоток Y или Yg. При этом правильно считаются токи и напряжения при КЗ за трансформатором Y/D.
- Поддержка взаимоиндукций нулевой последовательности между ветвями с возможностью независимого задания M12,M21
- Поддержка следующих видов КЗ и обрывов: 
	'A0','B0','C0' - металлические однофазные КЗ на землю или обрыв соответствующей фазы;
        'A0r','B0r','C0r' - однофазные КЗ на землю через переходное сопротивление;
        'AB','BC','CA' - металлические двухфазные КЗ  или обрыв соответствующих фаз;
        'ABr','BCr','CAr' - двухфазные КЗ через переходное сопротивление;
        'AB0','BC0','CA0' - металлические двухфазные КЗ на землю;
        'ABC' - трехфазное КЗ без земли  или обрыв трех фаз;
        'ABC0' - трехфазное КЗ на землю;
        'N0' - Заземление в узле в схеме нулевой последовательности или обрыв по нулевой последовательности на ветви.
- Псевдотабличный вывод результатов расчетов по узлам, ветвям и несимметриям.
- Возможность получения конкетного параметра напряжения, тока по по узлам, ветвям и несимметриям с целью его дальнейшего использования в расчетах.
- На данный момент отсутствует возможность изменения расчетной схемы модели с помощью команд (Каскады, пром КЗ, отключения с или без заземления необходимо реализовывать корректировкой скрипта модели). Изменение электрических параметров ветвей, взаимоиндукций и несимметрий можно изменять с помощью методов edit, реализованных в соответствующих классах ветвей, взаимоиндукций и несимметрий. 

Краткое руководство пользователя
1. Формирование модели.
1.1 Импорт Модуля МРТКЗ для использования реализованных в нем классов, методов и функций
import mrtkz3 as mrtkz 
1.2 Создание (инициализация) модели, в которой будут хранится узлы, ветви, взаимоиндукции и несимметрии и взаимосвязь между ними
mdl=mrtkz.Model()
1.3 Создание узлов (не должны создаваться лишние узлы, в этом случае СЛАУ не будет решаться)
q1 = mrtkz.Q(mdl,'Название узла')
q2 = mrtkz.Q(mdl,'Название узла')
q3 = mrtkz.Q(mdl,'Название узла')
1.4 Создание ветвей
- Ветви источников питания (систем, генераторов станций и т.п.)
E1 = mrtkz.P(mdl,'Название ветви',0,q1,(Z1,Z2,Z0),E=(E1,E2,E0))
- Простые ветви 
Z1 = mrtkz.P(mdl,'Название ветви',q1,q2,(Z1,Z2,Z0))
- Ветви с поперечной емкостной проводимостью 
ZB1 = mrtkz.P(mdl,'Название ветви',q1,q2,(Z1,Z2,Z0),B=(B1,B2,B0))
- Трансформаторные ветви
T1 = mrtkz.P(mdl,'Название ветви',q2,q3,(Z1,Z2,Z0),T=(Ktr,GrT))
1.5 Создание взимоиндукций нулевой последовательности
M12 = mrtkz.M(mdl,'Название взимоиндукции',Z1,ZB1,M12,M21)
1.6 Создание несимметрий
- Заземление нейтрали трансформатора T1 Yg/D (например для пары обмоток 110/10)
NT1 = mrtkz.N(mdl,'Заземление нейтрали',q3,'N0')
- Обрыв трансформаторной ветви по нулевой последовательности (например для пары обмоток 110/35)
NT2 = mrtkz.N(mdl,'Обрыв нейтрали',T1,'N0')
- КЗ в узле 
KZ1 = mrtkz.N(mdl,'Название КЗ',q2,'A0')
KZ2 = mrtkz.N(mdl,'Название КЗ',q3,'BCr',r=1.0)
- Обрыв ветви
O1 = mrtkz.N(mdl,'Название Обрыва',Z1,'BC')
2. Расчет электрических величин токов и напряжений.
mdl.Calc()
3. Получение результатов.
3.1 Псевдотабличный вывод результатов расчета
- для узла
q1.res()
- для ветви со стороны 1-ого узла
ZB1.res1()
- для ветви со стороны 2-ого узла
ZB1.res2()
- для несимметрии
KZ1.res()
3.2 Получение конкетного параметра результата расчета в виде комплексного числа
KZ1.res('IA')
KZ1.res('U1')
KZ1.res('3I0')
3.3 Получение конкетного параметра результата расчета в требуемом виде 
(Модуль - 'M', угол - '<f', активная составляющая - 'R', реактивная составляющая - 'X', строки 'R+jX' или 'M<f')
KZ1.res('IA','M')
KZ1.res('U1','M<f')
KZ1.res('ZAB','X')

История изменений

03.12.2020
- Оптимизирован метод mdl.Calc, в части понижения потребляемой памяти и повышения
  быстродействия, за счет отказа от использования списков python для формирования
  координатной разреженной матрицы, вместо этого используются вектора numpy;
- Произведен переход на расчет фазных, междуфазных (линейных) и прочих величин
  с помощью матричного умножения результатов в симметричных составляющих на
  преобразующие матрицы (Ms2f - для вычисления фазных величин, Ms2ff - для
  вычисления междуфазных (линейных) величин);
- При формировании разреженной матрицы в ходе перебора типов несимметрий для
  повышения быстродействия на первое место поставлены КЗ 'N0' и обрыв 'N0'
  как ниболее часто встречающиеся в модели;
- Оптимизирован код, по выводу результатов расчетов, изменен порядок вывода
  результата, сначала идут фазные значения, потом симметричные составляющие
  и наконец междуфазные (линейные) величины. Уменьшено дублирование кода.
  
28.11.2020
1. В классе Model добавлен метод ImportFromPVL(PVL_Sech), предназначенный для
   импорта результатов расчетов параметров схемы замещения ВЛ с помощью модуля PVL
   mdl.ImportFromPVL(PVL_Sech)
   где PVL_Sech - ссылка на сечение (объект класса sech модуля PVL)

18.11.2020
1. Добавлены описания к функциям, классам и методам МРТКЗ,
    в том числе дано подробное описание алгоритма метода mdl.Calc()
2. Добавлены специальные нeсимметрии вида:
    - КЗ по нулевой последовательности - 'N0' для моделирования заземления нейтрали за
      трансформатором Yg/D или за соответствующей парой обмоток тр-ра
    - Обрыв по нулевой последовательности - 'N0' для моделирования сети с изолированной
      нейтралью, устанавливается на ветви разделяющей сеть с глухо или эффективно
      заземленной нейтралью и сетью с изолированной нейтралью
3. Выверено моделирование ветвей с поперечной емкостной проводимостью B,
    для этого если pl62w+ или аналогичное ПО выдает (Например)
    B1 = В2 = 90 мкСм (1/Ом*10^-6), B0 = 60 мкСм (1/Ом*10^-6)
    то при создании ветви надо заполнять параметры емкостной проводимости
    B=(90e-6j,90e-6j,60e-6j)
4. Выверено моделирование трансформаторных ветвей
    T=(Ktrans,GrT) - безразмерные параметры трансформаторной ветви:
    Ktrans - коэффициент трансформации силового трансформатора, например 115/11
    GrT - группа обмоток обмотки подключенной к узлу 2 (от 0 до 11)
    Так например для трансформатора с номинальными напряжениями обмоток 115 и 10,5 кВ
    и схемой соединения обмоток Y/D-11 надо заполнять параметры трансформаторной ветви
    T=(115/10.5,11)
5. Добавлены новые методы класса Model
    - AddNQ для группового добавления узлов (сечения узлов)
    mdl.AddNQ(NQ,Nname)
    где NQ - количество создаваемых узлов
        Nname - общее имя узлов, к уникальному имени узлу будет добавляться
        номер из сечения от 1 до NQ
    - AddNP для группового добавления ветвей (сечения ветвей)
    в том числе с поперечной емкостной проводимостью B и
    взаимоиндукцией нулевой последовательности
    mdl.AddNP(self,Nname,listq1,listq2,Z12,Z0) - без учета емкостной проводимости
    mdl.AddNP(self,Nname,listq1,listq2,Z12,Z0,B12,B0) - с учетом емкостной проводимости
    где listq1 и listq2 - сечения (списки) узлов
        Nname - общее имя сечения ветвей, к уникальному имени ветви будет добавляться
        номер из сечения от 1 до N, где N - количество создаваемых ветвей
        Z12 - вектор numpy.ndarray значений сопротивлений ветвей прямой/обратной последовательности
        Z0 - квадратная матрица numpy.ndarray значений сопротивлений ветвей и взаимоиндукций нулевой последовательности
        B12 - вектор numpy.ndarray значений поперечной емкостной проводимости прямой/обратной последовательности
        B0 - квадратная матрица numpy.ndarray значений поперечной емкостной проводимости нулевой последовательности
